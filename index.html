<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>MiroZoom</title>
</head>
<body style="font-size:300%;">
    <h1 >MiroTalk Zoom/Pan</h1>
    <h2>installation:</h2>
    <p>Drag this link to your bookmarks toolbar: 
    <a href="javascript:(function(){var v=document.querySelector('video[id$=&quot;___screen&quot;]');if(!v){alert('No video with id ending ___screen found');return;}var origParent=v.parentNode,nextSibling=v.nextSibling,origStyle=v.getAttribute('style')||'',origControls=!!v.hasAttribute('controls')||v.controls;var container=document.createElement('div');Object.assign(container.style,{position:'fixed',inset:'0',display:'flex',alignItems:'center',justifyContent:'center',zIndex:2147483647,overflow:'hidden',background:'transparent',WebkitUserSelect:'none'});var inner=document.createElement('div');Object.assign(inner.style,{position:'relative',touchAction:'none',cursor:'grab',maxWidth:'100%',maxHeight:'100%',display:'flex',alignItems:'center',justifyContent:'center',overflow:'hidden'});inner.appendChild(v);container.appendChild(inner);document.documentElement.appendChild(container);v.style.maxWidth='none';v.style.maxHeight='none';v.style.touchAction='none';v.style.cursor='grab';v.style.transformOrigin='center center';/* remove native controls so play/timer UI won't show */try{v.removeAttribute('controls');v.controls=false;}catch(_){ }/* provide click/keyboard playback toggle */inner.addEventListener('click',function(e){if(e.detail===1){if(v.paused||v.ended){v.play().catch(()=>{});}else{v.pause();}}});var scale=1,tx=0,ty=0,dragging=false,startX=0,startY=0,startTx=0,startTy=0;var pointers={},pinchStartDist=0,pinchStartScale=1,pinchMidX=0,pinchMidY=0;function apply(){v.style.transform='translate('+tx+'px,'+ty+'px) scale('+scale+')';}function zoomAt(clientX,clientY,factor){var prev=scale;scale=Math.max(0.2,Math.min(6,scale*factor));var rect=v.getBoundingClientRect();var cx=clientX-rect.left,cy=clientY-rect.top;tx=tx-(cx)*(scale/prev-1);ty=ty-(cy)*(scale/prev-1);apply();}function reset(){scale=1;tx=0;ty=0;apply();}inner.addEventListener('wheel',function(e){if(e.ctrlKey||e.metaKey){e.preventDefault();var factor=e.deltaY>0?0.95:1.05;zoomAt(e.clientX,e.clientY,factor);}},{passive:false});function onKey(e){if(e.key==='Escape')cleanup();if(e.key===' '){e.preventDefault();if(v.paused||v.ended){v.play().catch(()=>{});}else{v.pause();}}if((e.ctrlKey||e.metaKey)&& (e.key==='+'||e.key==='=')){e.preventDefault();zoomAt(window.innerWidth/2,window.innerHeight/2,1.1);}if((e.ctrlKey||e.metaKey)&& e.key==='-'){e.preventDefault();zoomAt(window.innerWidth/2,window.innerHeight/2,0.9);}if((e.ctrlKey||e.metaKey)&& e.key==='0'){e.preventDefault();reset();}}inner.addEventListener('pointerdown',function(e){e.preventDefault();inner.setPointerCapture(e.pointerId);pointers[e.pointerId]={x:e.clientX,y:e.clientY};var count=Object.keys(pointers).length;if(count===1){dragging=true;inner.style.cursor='grabbing';startX=e.clientX;startY=e.clientY;startTx=tx;startTy=ty;}else if(count===2){var ids=Object.keys(pointers);var p1=pointers[ids[0]],p2=pointers[ids[1]];pinchStartDist=Math.hypot(p2.x-p1.x,p2.y-p1.y);pinchStartScale=scale;pinchMidX=(p1.x+p2.x)/2;pinchMidY=(p1.y+p2.y)/2;}});inner.addEventListener('pointermove',function(e){if(!(e.pointerId in pointers))return;pointers[e.pointerId]={x:e.clientX,y:e.clientY};var count=Object.keys(pointers).length;if(count===1&&dragging){tx=startTx+(e.clientX-startX);ty=startTy+(e.clientY-startY);apply();}else if(count>=2){var ids=Object.keys(pointers);var p1=pointers[ids[0]],p2=pointers[ids[1]];var dist=Math.hypot(p2.x-p1.x,p2.y-p1.y);if(pinchStartDist>0){var prev=scale;scale=Math.max(0.2,Math.min(6,pinchStartScale*(dist/pinchStartDist)));var rect=v.getBoundingClientRect();var cx=pinchMidX-rect.left,cy=pinchMidY-rect.top;tx=tx-(cx)*(scale/prev-1);ty=ty-(cy)*(scale/prev-1);apply();}}});function pointerUp(e){if(e.pointerId in pointers)delete pointers[e.pointerId];try{inner.releasePointerCapture(e.pointerId);}catch(_){ }var count=Object.keys(pointers).length;if(count<2){pinchStartDist=0;pinchStartScale=scale;}if(count===0){dragging=false;inner.style.cursor='grab';}else if(count===1){var ids=Object.keys(pointers);var p=pointers[ids[0]];startX=p.x;startY=p.y;startTx=tx;startTy=ty;dragging=true;inner.style.cursor='grabbing';}}inner.addEventListener('pointerup',pointerUp);inner.addEventListener('pointercancel',pointerUp);v.addEventListener('dblclick',function(){var fs=document.fullscreenElement;if(!fs)container.requestFullscreen().catch(()=>{});else document.exitFullscreen().catch(()=>{});});function cleanup(){try{if(document.fullscreenElement)document.exitFullscreen().catch(()=>{});}catch(e){};try{document.removeEventListener('keydown',onKey);}catch(_){ }container.parentNode&&container.parentNode.removeChild(container); if(origParent) origParent.insertBefore(v,nextSibling); try{v.setAttribute('style',origStyle);}catch(_){v.style.cssText=origStyle;}/* restore native controls if they were present */try{if(origControls){v.setAttribute('controls','');v.controls=true;}else{v.removeAttribute('controls');v.controls=false;}}catch(_){ }document.removeEventListener('keydown',onKey);}document.addEventListener('keydown',onKey);})();">MiroZoom</a></p>
    <h2>usage:</h2>
    <p>After a MiroTalk host shares their screen, click the bookmark to enable zoom and pan on the shared video.</p>
</body>
</html>